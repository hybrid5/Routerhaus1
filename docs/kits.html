<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>RouterHaus · Kits</title>

  <!-- Preloads -->
  <link rel="preload" href="kits.json" as="fetch" crossorigin="anonymous">

  <!-- Global styles -->
  <link rel="stylesheet" href="main.css">
  <!-- Page styles -->
  <link rel="stylesheet" href="assets/css/kits.css">

  <!-- Meta -->
  <meta name="description" content="Filter and compare the best Wi-Fi router kits for your home or office.">
</head>
<body>
  <!-- Header mount (populated by your site loader, keeps CLS low) -->
  <div id="header-placeholder" aria-hidden="true"></div>

  <main id="main" class="container kits-layout" role="main">
    <!-- Page header -->
    <header class="page-header">
      <h1 class="page-title">RouterHaus Kits</h1>
      <p class="page-subtitle">Answer a few questions or use filters to find your perfect setup.</p>
      <div class="page-cta">
        <button id="openQuizBtn" class="btn btn-primary">Start Recommendation</button>
        <button id="openMobileFiltersBtn" class="btn btn-secondary show-md:hide" aria-controls="filtersDrawer" aria-expanded="false">Filters</button>
      </div>
    </header>

    <div class="content-grid">
      <!-- Desktop filter rail -->
      <aside id="filtersAside" class="filters-rail glass hide-sm" aria-label="Filters">
        <div class="filters-header">
          <h2 class="filters-title">Filters</h2>
          <small id="matchCount" class="filters-count" aria-live="polite"></small>
        </div>

        <div class="filters-actions">
          <button id="expandAllFacets" class="btn-ghost" type="button">Expand all</button>
          <button id="collapseAllFacets" class="btn-ghost" type="button">Collapse all</button>
          <button id="clearAllFacets" class="btn-link danger" type="button">Clear all</button>
        </div>

        <form id="filtersForm" class="filters-form" aria-describedby="matchCount">
          <!-- Quick chips -->
          <section class="facet" data-facet="quick">
            <h3 class="facet__title">Quick picks</h3>
            <div id="quickChips" class="chips"></div>
          </section>

          <!-- Brand -->
          <details class="facet" data-facet="brand" open>
            <summary class="facet__title">Brand</summary>
            <button class="facet__clear" type="button" data-clear="brand" aria-label="Clear Brand">Clear</button>
            <div class="facet__options" id="facet-brand"></div>
          </details>

          <!-- Wi-Fi Gen -->
          <details class="facet" data-facet="wifiStandard" open>
            <summary class="facet__title">Wi-Fi Generation</summary>
            <button class="facet__clear" type="button" data-clear="wifiStandard" aria-label="Clear Wi-Fi Generation">Clear</button>
            <div class="facet__options" id="facet-wifiStandard"></div>
          </details>

          <!-- Mesh -->
          <details class="facet" data-facet="meshReady">
            <summary class="facet__title">Mesh</summary>
            <button class="facet__clear" type="button" data-clear="meshReady" aria-label="Clear Mesh">Clear</button>
            <div class="facet__options" id="facet-meshReady"></div>
          </details>

          <!-- WAN Tier -->
          <details class="facet" data-facet="wanTier">
            <summary class="facet__title">WAN Tier</summary>
            <button class="facet__clear" type="button" data-clear="wanTier" aria-label="Clear WAN Tier">Clear</button>
            <div class="facet__options" id="facet-wanTier"></div>
          </details>

          <!-- Coverage -->
          <details class="facet" data-facet="coverageBucket">
            <summary class="facet__title">Coverage</summary>
            <button class="facet__clear" type="button" data-clear="coverageBucket" aria-label="Clear Coverage">Clear</button>
            <div class="facet__options" id="facet-coverageBucket"></div>
          </details>

          <!-- Device Load -->
          <details class="facet" data-facet="deviceLoad">
            <summary class="facet__title">Device Load</summary>
            <button class="facet__clear" type="button" data-clear="deviceLoad" aria-label="Clear Device Load">Clear</button>
            <div class="facet__options" id="facet-deviceLoad"></div>
          </details>

          <!-- Primary Use -->
          <details class="facet" data-facet="primaryUse">
            <summary class="facet__title">Primary Use</summary>
            <button class="facet__clear" type="button" data-clear="primaryUse" aria-label="Clear Primary Use">Clear</button>
            <div class="facet__options" id="facet-primaryUse"></div>
          </details>

          <!-- Access -->
          <details class="facet" data-facet="accessSupport">
            <summary class="facet__title">Access Type</summary>
            <button class="facet__clear" type="button" data-clear="accessSupport" aria-label="Clear Access Type">Clear</button>
            <div class="facet__options" id="facet-accessSupport"></div>
          </details>

          <!-- Price -->
          <details class="facet" data-facet="priceBucket">
            <summary class="facet__title">Price</summary>
            <button class="facet__clear" type="button" data-clear="priceBucket" aria-label="Clear Price">Clear</button>
            <div class="facet__options" id="facet-priceBucket"></div>
          </details>
        </form>

        <!-- Compare in rail (desktop) -->
        <section class="compare-panel" aria-label="Compare">
          <div class="compare-panel__header">
            <h3 class="compare-title">Compare</h3>
            <button id="clearCompareBtn" class="btn-link danger" type="button">Clear</button>
          </div>
          <div id="compareList" class="compare-list" aria-live="polite"></div>
          <button id="compareNowBtn" class="btn btn-primary" type="button" disabled>Compare Now</button>
        </section>
      </aside>

      <!-- Results column -->
      <section class="results-col">
        <!-- Active filter chips -->
        <div id="activeChips" class="active-chips" aria-live="polite"></div>

        <!-- Results toolbar -->
        <div class="results-toolbar">
          <div class="toolbar-left">
            <label for="sortSelect" class="sr-only">Sort</label>
            <select id="sortSelect" class="select">
              <option value="relevance">Sort: Relevance</option>
              <option value="wifi_desc">Wi-Fi Gen (high → low)</option>
              <option value="price_asc">Price (low → high)</option>
              <option value="price_desc">Price (high → low)</option>
              <option value="coverage_desc">Coverage (high → low)</option>
              <option value="wan_desc">WAN Tier (high → low)</option>
              <option value="reviews_desc">Reviews (high → low)</option>
            </select>

            <label for="pageSizeSelect" class="sr-only">Results per page</label>
            <select id="pageSizeSelect" class="select page-size">
              <option value="12">12 / page</option>
              <option value="24">24 / page</option>
              <option value="48">48 / page</option>
            </select>
          </div>

          <div class="toolbar-right">
            <label class="toggle">
              <input id="showRecosToggle" type="checkbox" />
              <span>Show recommendations</span>
            </label>
          </div>
        </div>

        <!-- Top pagination -->
        <nav id="pagerTop" class="pager" aria-label="Pagination (top)"></nav>

        <!-- Recommendations -->
        <section id="recoBlock" class="reco-block" hidden>
          <h2 class="reco-title">Recommended for you</h2>
          <div id="recoGrid" class="grid grid-recos" role="region" aria-label="Recommended kits"></div>
        </section>

        <!-- Results -->
        <section class="results-wrap">
          <!-- Loading skeletons -->
          <div id="resultsSkeleton" class="results-skeleton" aria-hidden="true">
            <div class="card-skeleton"></div>
            <div class="card-skeleton"></div>
            <div class="card-skeleton"></div>
            <div class="card-skeleton"></div>
            <div class="card-skeleton"></div>
            <div class="card-skeleton"></div>
          </div>

          <!-- Empty state -->
          <div id="emptyState" class="empty-state" hidden>
            <h3>No matches</h3>
            <p>Try clearing a filter or use a quick pick:</p>
            <div id="emptyQuickChips" class="chips"></div>
            <button id="resetAllBtn" class="btn btn-secondary" type="button">Reset all</button>
          </div>

          <!-- Results grid -->
          <div id="kitResults" class="grid grid-results" role="region" aria-label="Search results"></div>
        </section>

        <!-- Bottom pagination -->
        <nav id="pagerBottom" class="pager" aria-label="Pagination (bottom)"></nav>
      </section>
    </div>
  </main>

  <!-- Mobile filters drawer -->
  <div id="filtersDrawer" class="drawer hide-md" role="dialog" aria-modal="true" aria-labelledby="filtersDrawerTitle" hidden>
    <div class="drawer__backdrop" data-close="drawer"></div>
    <div class="drawer__panel glass">
      <header class="drawer__header">
        <h2 id="filtersDrawerTitle">Filters</h2>
        <button class="icon-btn" data-close="drawer" aria-label="Close filters">×</button>
      </header>
      <div class="drawer__body">
        <!-- The desktop #filtersForm is cloned/mounted here by JS for mobile -->
        <div id="filtersDrawerMount"></div>
      </div>
      <footer class="drawer__footer">
        <button id="applyMobileFilters" class="btn btn-primary" type="button">Apply</button>
        <button id="clearMobileFilters" class="btn btn-link danger" type="button">Clear all</button>
      </footer>
    </div>
  </div>

  <!-- Compare drawer (mobile) -->
  <div id="compareDrawer" class="drawer hide-md" role="dialog" aria-modal="true" aria-labelledby="compareDrawerTitle" hidden>
    <div class="drawer__backdrop" data-close="compare"></div>
    <div class="drawer__panel glass">
      <header class="drawer__header">
        <h2 id="compareDrawerTitle">Compare</h2>
        <button class="icon-btn" data-close="compare" aria-label="Close compare">×</button>
      </header>
      <div class="drawer__body">
        <div id="compareListMobile" class="compare-list"></div>
      </div>
      <footer class="drawer__footer">
        <button id="compareNowBtnMobile" class="btn btn-primary" type="button" disabled>Compare Now</button>
        <button id="clearCompareBtnMobile" class="btn btn-link danger" type="button">Clear</button>
      </footer>
    </div>
  </div>

  <!-- Quiz modal -->
  <dialog id="quizModal" class="modal" aria-labelledby="quizTitle" aria-modal="true">
    <form method="dialog" class="modal__panel glass" id="quizForm">
      <header class="modal__header">
        <h2 id="quizTitle">Quick Recommendation</h2>
        <button type="button" class="icon-btn" data-close="quiz" aria-label="Close quiz">×</button>
      </header>

      <div class="modal__body" id="quizBody">
        <!-- quiz-modal.js generates steps/inputs; keep mount -->
        <div id="quizSteps"></div>
      </div>

      <footer class="modal__footer">
        <button type="button" class="btn btn-secondary" data-close="quiz">Cancel</button>
        <button id="quizSubmitBtn" type="submit" class="btn btn-primary">See Results</button>
      </footer>
    </form>
  </dialog>

  <!-- Footer mount -->
  <div id="footer-placeholder" aria-hidden="true"></div>

  <!-- Scripts -->
  <script defer src="assets/js/quiz-modal.js"></script>
  <script defer src="assets/js/kits.js"></script>

  <!-- Progressive enhancement fallback -->
  <noscript>
    <div class="noscript">
      <p>Please enable JavaScript to use filters and see results.</p>
      <p><a href="kits.json">View raw dataset</a></p>
    </div>
  </noscript>
</body>
</html>
